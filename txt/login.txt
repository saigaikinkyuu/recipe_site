import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
import { getFirestore, doc, setDoc, collection, getDoc, getDocs, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-firestore.js";
import { initializeAppCheck, ReCaptchaEnterpriseProvider } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app-check.js";
import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-auth.js";

const firebaseConfig = {
    apiKey: "AIzaSyDzslg1WbmtYBNFtR3BrrHVvXYTeqanDr8",
    authDomain: "home-recipe-be23b.firebaseapp.com",
    projectId: "home-recipe-be23b",
    storageBucket: "home-recipe-be23b.firebasestorage.app",
    messagingSenderId: "801879261323",
    appId: "1:801879261323:web:0d2f9552d1058ee99d948e",
    measurementId: "G-Y12V9FEK27"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth();
const RECAPTCHA_SITE_KEY = "6LeJnu8rAAAAACzYKvXoSxPDfgWlKHa7ftgB2GYN";

const appCheck = initializeAppCheck(app, {
    provider: new ReCaptchaEnterpriseProvider(RECAPTCHA_SITE_KEY),
    isProactiveRefresh: true
});
const db = getFirestore(app);

function Main() {
    const email = document.querySelector("#email");
    const pass = document.querySelector("#password");
    const submit = document.querySelector("#submit");

    submit.addEventListener('click', () => {
        if (!email.value && !pass.value) return
        const auth = getAuth();
        signInWithEmailAndPassword(auth, email.value, pass.value)
            .then((userCredential) => {
                //empty
            })
            .catch((error) => {
                console.error(error);
                alert(error);
            });
    })
}

onAuthStateChanged(auth, (user) => {
    if (user) {
        window.location.href = "../";
    } else {
        Main();
    }
})